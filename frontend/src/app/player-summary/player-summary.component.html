<div class="container player-selection">
  <h2>Please select the player ID</h2>
  <div>
    <mat-form-field>
      <mat-select
        [(ngModel)]="selectedPlayerID"
        [ngModelOptions]="{ standalone: true }"
        (selectionChange)="onPlayerSelectionChange()"
      >
        <mat-option
          *ngFor="let _ of [].constructor(31); let i = index"
          [value]="i + 1"
        >
          {{ i + 1 }}
        </mat-option>
      </mat-select>
    </mat-form-field>
  </div>

  <div *ngIf="playerSummary" id="player-container">
    <mat-card class="player-name-card">
      <mat-card-title
        >Player Information
        <hr
      /></mat-card-title>
      <mat-card-content>
        <p><strong>Name:</strong> {{ playerSummary.name }}</p>
        <p><strong>Team:</strong> {{ playerSummary.team }}</p>
      </mat-card-content>
    </mat-card>

    <div class="game-details-container">
      <mat-card class="game-data-card">
        <mat-card-title
          >Game Data
          <hr
        /></mat-card-title>

        <mat-card-content>
          <p>
            <strong>*</strong> Specific game data for
            <strong>{{ playerSummary.name }}</strong> across all games
          </p>
          <mat-tab-group>
            <mat-tab
              *ngFor="let game of playerSummary.games"
              label="{{ game.date }}"
            >
              <div class="game-stats">
                <div class="stats-column">
                  <p><strong>Minutes:</strong> {{ game.minutes }}</p>
                  <p><strong>Points:</strong> {{ game.points }}</p>
                  <p><strong>Assists:</strong> {{ game.assists }}</p>
                  <p>
                    <strong>Offensive Rebounds:</strong>
                    {{ game.offensiveRebounds }}
                  </p>
                  <p>
                    <strong>Defensive Rebounds:</strong>
                    {{ game.defensiveRebounds }}
                  </p>
                  <p><strong>Steals:</strong> {{ game.steals }}</p>
                  <p><strong>Blocks:</strong> {{ game.blocks }}</p>
                  <p><strong>Turnovers:</strong> {{ game.turnovers }}</p>
                  <p>
                    <strong>Offensive Fouls:</strong> {{ game.offensiveFouls }}
                  </p>
                  <p>
                    <strong>Defensive Fouls:</strong> {{ game.defensiveFouls }}
                  </p>
                  <p>
                    <strong>Free Throws Made:</strong> {{ game.freeThrowsMade }}
                  </p>
                  <p>
                    <strong>Free Throws Attempted:</strong>
                    {{ game.freeThrowsAttempted }}
                  </p>
                  <p>
                    <strong>Two Pointers Made:</strong>
                    {{ game.twoPointersMade }}
                  </p>
                  <p>
                    <strong>Two Pointers Attempted:</strong>
                    {{ game.twoPointersAttempted }}
                  </p>
                  <p>
                    <strong>Three Pointers Made:</strong>
                    {{ game.threePointersMade }}
                  </p>
                  <p>
                    <strong>Three Pointers Attempted:</strong>
                    {{ game.threePointersAttempted }}
                  </p>
                </div>

                <div class="stats-column">
                  <div class="shots-stats">
                    <strong>Shots</strong>
                    <li *ngFor="let shot of game.shots">
                      Location: ({{ shot.locationX }}, {{ shot.locationY }}) -
                      {{ shot.isMake ? "Made" : "Missed" }}
                    </li>
                  </div>
                </div>
              </div>
            </mat-tab>
          </mat-tab-group>
        </mat-card-content>
      </mat-card>

      <mat-card class="game-plot-card">
        <mat-card-title
          >Game Plot
          <hr
        /></mat-card-title>
        <mat-card-content>
          <p>
            <strong>*</strong> Graph of shots taken by
            <strong>{{ playerSummary.name }}</strong> across all games
          </p>
          <p>
            Locations of <strong>made shots</strong> are marked as
            <strong><span style="color: green">green</span></strong>
          </p>
          <p>
            Locations of <strong>missed shots</strong> are marked as
            <strong><span style="color: red">red</span></strong>
          </p>
          <div class="court-diagram">
            <svg id="shotChart" width="500" height="500"></svg>
            <div id="tooltip" class="hidden">
              <p id="tooltipContent"></p>
            </div>
          </div>
          <p></p>
          <p>
            Tips: Place your cursor on the shot point to reveal more details.
          </p>
        </mat-card-content>
      </mat-card>
    </div>

    <mat-card class="player-summary-card">
      <mat-card-title
        >Player Summary
        <hr
      /></mat-card-title>
      <mat-card-content>
        <p>
          <strong>*</strong> The player capability summary for
          <strong>{{ playerSummary.name }}</strong>
        </p>
        <div>
          <p><strong>Player Performance Breakdown</strong></p>
          <div class="large-chart">
            <ngx-charts-pie-chart
              [results]="performancePieChartData"
              [scheme]="{
                domain: [
                  '#007ac1',
                  '#005a91 ',
                  '#339ed4 ',
                  '#4cb8e6 ',
                  '#66d0f0 ',
                  '#80daf9 ',
                  '#99e4ff ',
                  '#b3efff'
                ]
              }"
            ></ngx-charts-pie-chart>
          </div>
        </div>

        <div class="progress-bar-container">
          <div class="stats-column">
            <p><strong>Shots Accuracy</strong></p>
            <span>Shots Accuracy (Free Throws):</span>
            <div class="progress-container">
              <progress
                max="100"
                [value]="
                  totalFreeThrowsAttempted == 0
                    ? 0
                    : (totalFreeThrowsMade / totalFreeThrowsAttempted) * 100
                "
              ></progress>
              <span>{{
                totalFreeThrowsAttempted == 0
                  ? "N/A"
                  : ((totalFreeThrowsMade / totalFreeThrowsAttempted) * 100
                      | number : "1.0-0") + "%"
              }}</span>
            </div>
            <div>
              <span>Shos Accuracy (Two Pointers):</span>
              <progress
                max="100"
                [value]="
                  totalTwoPointersAttempted == 0
                    ? 0
                    : (totalTwoPointersMade / totalTwoPointersAttempted) * 100
                "
              ></progress>
              <span>{{
                totalTwoPointersAttempted == 0
                  ? "N/A"
                  : ((totalTwoPointersMade / totalTwoPointersAttempted) * 100
                      | number : "1.0-0") + "%"
              }}</span>
            </div>
            <div>
              <span>Shots Accuracy (Three Pointers):</span>
              <progress
                max="100"
                [value]="
                  totalThreePointersAttempted == 0
                    ? 0
                    : (totalThreePointersMade / totalThreePointersAttempted) *
                      100
                "
              ></progress>
              <span>{{
                totalThreePointersAttempted == 0
                  ? "N/A"
                  : ((totalThreePointersMade / totalThreePointersAttempted) *
                      100 | number : "1.0-0") + "%"
              }}</span>
            </div>
            <div>
              <span>Shots Accuracy (Overall):</span>
              <progress
                max="100"
                [value]="
                  totalShotsAttempted == 0
                    ? 0
                    : (totalShotsMade / totalShotsAttempted) * 100
                "
              ></progress>
              <span>{{
                totalShotsAttempted == 0
                  ? "N/A"
                  : ((totalShotsMade / totalShotsAttempted) * 100
                      | number : "1.0-0") + "%"
              }}</span>
            </div>
          </div>

          <div class="stats-column">
            <p><strong>Shots Breakdown</strong></p>
            <div class="small-chart">
              <ngx-charts-pie-chart
                [results]="shotsPieChartData"
                [scheme]="{
                  domain: [
                    '#007ac1',
                    '#005a91',
                    '#339ed4',
                    '#4cb8e6',
                    '#80c7ee',
                    '#b3daf7'
                  ]
                }"
              ></ngx-charts-pie-chart>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>

<mat-tab-nav-panel #tabPanel>
  <router-outlet></router-outlet>
</mat-tab-nav-panel>
